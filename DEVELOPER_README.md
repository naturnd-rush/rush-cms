# Development Instructions
This document contains some guidelines, helpful tips, and various commands for developing your own Webmap!

## Getting Started
### To get started developing a Webmap, you will first need to download and install some prerequisite software
1. [NodeJS](https://nodejs.org/en/download) <-- our application runtime.
2. Docker (recommended) <-- to run the dev database container.
    - On Linux [Install Docker Engine](https://docs.docker.com/engine/install/).
    - On Windows/Mac [Install Docker Desktop](https://www.docker.com/get-started/).
3. PostgreSQL (optional) <-- if you're familiar with the psql CLI, you can create a development database locally instead of using Docker.

### Environment Setup
1. Clone this repository.
2. Run `npm install` inside both of the `/admin` and `/app` directories.
3. Run `docker compose -f "docker-compose.yml" up db --build -d` from the main project directory. Or, _optionally_, create your own development database locally using the psql CLI.
4. Run `npm run dev` in `/app`. You should now see the app running locally at [http://localhost:3000](http://localhost:3000).
5. In a separate terminal window, run `npm run dev` in `/admin`. You should now see the admin site running locally at [http://localhost:8000](http://localhost:8000). When you visit the Admin UI for the first time you will be asked to create an admin user.

### Development Workflow

2. TODO, describe how to run tests, etc.

### Tips and tricks
1. Avoid comitting the `schema.graphql` and `schema.prisma` files when collaborating with others, as both of these files are automatically generated by Keystone JS in `/admin` and the latter file is by Prisma in `/app`, which will cause many unecessary merge conflicts if multiple people are working on code at the same time.
2. The app relies on the admin site, whose `schema.ts` file is the source of truth for the database schema, to generate it's `schema.prisma` file. This means that any time you update the `admin/schema.ts` file, you will need to restart the admin site by re-running the `npm run dev` command. For convienence, `npm run dev` has been configured to copy the `schema.prisma` file from `/admin` to `/app`. However, you may need to restart the app as well for changes in the database to be reflected.

### Deployment
1. TODO: Maybe add notes about deployment here?
